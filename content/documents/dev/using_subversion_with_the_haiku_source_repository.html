+++
type = "article"
title = "Using Subversion with the Haiku Source Repository"
date = "2005-03-07T05:00:00.000Z"
tags = ["svn", "subversion", "obsolete"]
+++


    <div class="field field-type-text field-field-body">
    <div class="field-items">
            <div class="field-item odd">
                    <div class="box-info">
<strong>2011-November: This document is now obsolete. Subversion is no longer in use. We are in the process of consolidating and re-organizing the website documentation. For now please refer to the <a href="/guides">in-progress website documentation</a>.</strong>
</div>

<p>	As we&#39;ve already <a href="http://www.haiku-os.org/learn.php?mode=news_view&amp;id=372">announced 	earlier</a>, we&#39;re planning to switch our version control system from CVS to Subversion. 	While CVS is working nice basically, it&#39;s much too limited to serve as a good foundation 	for a project of a size like ours.  </p><p>	The following document should give you an introduction on how to use Subversion with our 	repository - it will not provide you with many details, but with some pointers in case you 	want to know more about Subversion. The current version of Subversion is 1.1.3. </p>

<!--more-->

<p>	It will also not cover the installation of Subversion on BeOS - alongside this document, 	we&#39;ve published a package that will take care of this for your convenience. To successfully 	use Subversion on BeOS with our provider of choice, <a href="http://developer.berlios.de">BerliOS</a>, 	you&#39;ll need an updated ssh client, a new pipe file system (developed by FranÃ§ois Revol), 	the flock_server (that provides a file locking service needed by several applications), 	and of course, a recent Subversion client. You have to thank Ingo Weinhold and David Reid 	for the availability of these ports for BeOS. </p>  <h3>Setting up the local repository</h3>  <p>	The most important difference for you is that you don&#39;t want to check out the entire 	repository anymore: unlike CVS, Subversion would leave you with all tags and branches 	as separate files on your hard drive - which totals in about 1.4 GB of files at the moment. 	Instead, you will specifically ask for the &quot;trunk&quot; only - that&#39;s what you already know 	as the CVS root now. And in there, you may also not need to check out the build tools, 	as these are available separately, and ready to be installed, anyway.  </p>  <h3>Checking out the sources</h3>  <p>	If you want to do an anonymous checkout, you don&#39;t need SSH - this should already work 	with the Subversion release as published on BeBits. To get a copy of the current Haiku 	tree (and Haiku only), you would write something like this: </p> <pre>	svn checkout <a href="http://svn.haiku-os.org/haiku/haiku/trunk" title="http://svn.haiku-os.org/haiku/haiku/trunk">http://svn.haiku-os.org/haiku/haiku/trunk</a> [directory-name]<br /></pre> <p>	This will create the directory &quot;trunk&quot; in the current working directory and put 	everything from the repository under haiku/trunk into it. If you don&#39;t like the 	name &quot;trunk&quot; on your disk, you can specify the optional directory-name  	parameter. </p> <p>	You&#39;ll probably notice that &quot;current&quot; is gone - it&#39;s now called &quot;haiku&quot;. Anyway, this 	should take a while, but give you a recent copy of our current sources. Note, before 	the actual switch, we&#39;ll be freezing CVS commits and then update the Subversion 	repository from the most recent one; what you currently get from BerliOS is quite 	outdated. </p> <p>	For a developer checkout, it&#39;s quite similar: </p> <pre>	svn checkout svn+ssh://svn.haiku-os.org/srv/svn/repos/haiku/haiku/trunk<br /></pre>  <p>	Don&#39;t be confused by the double password retrieval: that&#39;s obviously how it&#39;s 	meant to be (at least it&#39;s not a bug we claim credit for). It will only do 	that with the checkout command; update and all other 	commands needing access to the repository work as expected. But you may want 	<a href="http://developer.berlios.de/docman/display_doc.php?docid=31&amp;group_id=2">to 	store your public SSH key at BerliOS&#39;s</a> so that you don&#39;t ever have to 	type it in again.  </p> <p>	Note, if your local user account is different from your login name at BerliOS, the 	SVN_SSH variable must be set a bit differently for things to work: </p> <pre>	export SVN_SSH=&quot;ssh -l developername&quot;<br /></pre> <p>	You can pass other options to ssh this way as well if you wish. Unlike CVS, if 	your local user name is identical to your developer name at BerliOS, you don&#39;t 	have to set the variable at all, though. </p>  <h3>Keeping the sources up to date</h3>  <p>	This is an easy task, and is very similar to what you&#39;re used to from CVS:  </p> <pre>	svn update<br /></pre> <p>	Of course, this will also work in sub directories, in case you only want to 	update a certain piece of the tree. And just like with CVS, you don&#39;t have 	to specify the URL of the tree when you are issuing a command from inside 	a checked out tree. </p>  <h3>Some Subversion specials</h3>  <ul> 	<li>Unlike CVS, Subversion does not need a network connection to show you the 		changes you made to your working copy - this will reduce the network usage to 		a minimum (the svn status and svn diff commands). 		This has a couple of other advantages as well, like the svn revert  		command which you can use to undo local changes.</li> 	<li>Subversion has a real rename feature - now you can move files (and directories) 		around without losing the file&#39;s history.</li> 	<li>If a conflict occurs during an update, Subversion doesn&#39;t let you commit 		files marked as conflicting. After you&#39;ve resolved the conflict, you need 		to tell Subversion that the conflict is no longer an issue by calling 		svn resolved . You will also notice 		that Subversion helps you resolving the conflict by creating some files 		in your working copy that contain the originally checked out revision as 		well as the verbatim new revision of that file.</li> </ul>  <h3>Tags and branches</h3>  <p>	In CVS, tags are just common names for a set of files with specified 	revisions; branches add some hidden dimension to concerned files. That 	makes it not so easy to see which files are actually tagged, respectively 	are contained by a branch (unless you just check the tag/branch out). </p>  <p>	In Subversion, a tag is just a copy of the directories and files to be 	tagged, placed in a designated part of the repository. Branches are just 	the same, with the difference that while you usually leave tags alone 	once you have created them, in branches you still do editing. If you tag 	or branch from a branch, you guessed it, you just make a copy of the branch. 	All this copying sounds like a huge waste of storage, but in fact 	Subversion copies lazily; that is, no actual copy of a file&#39;s data is made 	until you start editing it. </p>  <p>	Regarding the special place for tags and branches in the repository I 	mentioned, best have a look at the layout of our directory structure: </p>  <pre>  buildtools/<br />    ...<br />  haiku/<br />    branches/<br />    tags/<br />    trunk/<br />    vendor/<br />      jam/<br />        current/<br />        2.4/<br />        2.5rc3/<br />      ...<br /><br /></pre>  <p>	As we had in CVS we have two main modules, buildtools and 	haiku. Here only the structure of the latter is shown. 	Little surprise, the subdirectories branches and 	tags are the places for branches and tags respectively. 	vendor is the place for vendor branches. It has 	subdirectories for the components whose contents are managed as 	described in the <a href="http://svnbook.red-bean.com/en/1.1/ch07s04.html">  		Subversion Book</a>. trunk has already been mentioned 	above; it is the main trunk of development. </p>  <p>	The directories branches and tags deserve a 	closer look. Both are structured exactly the same, so only 	branches will be described more in detail; everything applies 	analogously for tags. </p>  <pre>  haiku/<br />    branches/<br />      components/<br />        ShowImage/<br />          1.0-fixes/<br />        ...<br />      developer/<br />        axeld/<br />        ...<br />      haiku/<br />      old/<br />      team/<br />        kernel/<br />        ...<br /></pre>  <p>	The subdirectory components is intended for branches that 	concern only one component of Haiku which could be distributed independently 	of the OS itself, too. As an (imaginary) example say ShowImage: 	Version 1.0 is out and development for 2.0 with new features is in full 	progress, but it has been decided to release a bug fix version. For 	this purpose the 1.0-fixes branch has been created. By the 	way, it would most certainly not be a copy of the whole Haiku tree, but 	only of the respective subdirectory (src/apps/showimage). 	If your component has headers and sources, which are stored in separate 	subtrees in the Haiku source tree (headers and 	src respectively), you don&#39;t need to copy the whole Haiku 	source tree either. You can create the branch directory by hand and 	copy only the concerned parts of the tree into it. </p>  <p>	developer is the place for developer branches. Any 	developer who desires so can have a subdirectory. If you&#39;re paranoid 	and want to always commit your day&#39;s work even if it doesn&#39;t compile/work, 	this is the place. Or you have different computers you use for Haiku 	development and need a means to keep them in sync. Or you want to do 	experimental development. Just use this directory. Its inner structure 	is completely up to you. </p> 	 <p>	A similar place, just for whole teams, is the team 	subdirectory. It shall mainly be used for experimental development in which 	more than one team member is participating. For the inner directory 	structure the team is responsible.</p>  <p> Into haiku go all branches of the complete OS once we start 	releasing versions. </p>  <p> Finally there is the directory old which contains all branches 	that had been created with CVS and were converted to Subversion branches. 	To save the work of understanding what each one was for and sorting them into 	the respective directories above, we just put them here. When you need one 	of them, just move it into the directory it belongs to. Each branch 	starts at the directory current, but contains only the files 	that were actually branched. You usually want to move only the innermost 	directory containing all files. For example: </p>  <pre>$ svn mkdir -m &quot;Directory for jam branches.&quot; <br />	svn+ssh://svn.haiku-os.org/srv/svn/repos/haiku/branches/components/jam<br />$ svn mv -m &quot;Moved JAM2_4_VANILLA_FIXES branch to proper place.&quot;<br />	svn+ssh://svn.haiku-os.org/srv/svn/repos/haiku/branches/old/JAM2_4_VANILLA_FIXES/current/src/tools/jam<br /> 	svn+ssh://svn.haiku-os.org/srv/svn/repos/haiku/branches/components/jam/2.4-vanilla-fixes<br />$ svn rm -m &quot;No longer needed.&quot; <br />	svn+ssh://svn.haiku-os.org/srv/svn/repos/haiku/branches/old/JAM2_4_VANILLA_FIXES<br /></pre>  <p> This moves the branch JAM2_4_VANILLA_FIXES branch to its 	proper place, extracting only the relevant subdirectory. As you see we do 	this directly in the repository (only URLs are used), which is (despite 	the long command lines) the most convenient way for copying and moving 	directories (this includes creating tags and branches). </p>   <h3>Useful links:</h3>  <p>	If you&#39;re a developer, you probably need to know a little more about how to use 	Subversion. Here are some links that you might want to have a look at:  </p><ul> 	<li><a href="http://svnbook.red-bean.com/">&quot;Version Control with Subversion&quot;</a>, 		a book published by O&#39;Reilly that is also available online. Have a look at 		<a href="http://svnbook.red-bean.com/en/1.1/apa.html">Appendix A</a> &quot;Subversion 		for CVS Users&quot;</li> 	<li><a href="http://subversion.tigris.org/">Subversion Project Page</a></li> 	<li><a href="http://subversion.tigris.org/faq.html">Subversion FAQ</a></li> 	<li><a href="http://www.freelists.org/list/haiku-commits">Haiku SVN commits mailing list </a></li> </ul>        </div>
        </div>
</div>
  