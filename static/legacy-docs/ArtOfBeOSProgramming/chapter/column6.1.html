
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html lang="Ja">
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
	<title>Art of BeOS Programming</title>
	<link href="../css/format.css" rel="stylesheet" type="text/css">
	<link href="../css/layout.css" rel="stylesheet" type="text/css">
</head>

<body>

<div id="pagewidth">

<div id="main">
<span id="column_t">囲みコラム</span>
<h1>抽象化と再利用</h1>
<br/>
前の章のサンプルでは、ビュークラスのインスタンス、つまりビューオブジェクトを生成するのはウィンドウクラスの役割でした。それに対し、ここではその役割をアプリケーションクラスに移しているのですが、これには大きな理由があります。何だと思いますか?「ウィンドウクラスを再利用するためだ」と思った人は正解です。ウィンドウクラスにビューオブジェクトを生成させようとすると、そこに依存関係が生じます。つまり、生成するビューのクラスが何であるかにウィンドウクラスが依存し、違うビュークラスを使おうとすると、ウィンドウのクラスも一緒に変更する必要が出てしまうのです。<br/>
<br/>
実は、この章で紹介する四つのアプリケーションは、すべて同じウィンドウクラスを利用しています。すなわち、リスト6.3～6.4に示したSingleWindowのソースコードは、四つのアプリケーションを通じて再利用されているのです。それぞれのアプリケーションでは、マウスクリックに応答する処理をビュークラスによって行っており、それぞれ異なるビュークラスを使っています。そのため、ウィンドウクラスにビューオブジェクトを生成させたのでは、再利用できなくなってしまうのです。<br/>
<br/>
SingleWindowクラスのソースを見ると、InitContent()メソッドの引数としてBViewクラス型へのポインタを受け取ります。つまり、実際に受け取るビューオブジェクトのクラスが何であるかを関知せず、それらの基底クラス(親クラス)であるBViewクラスの情報しか持ちません。言い換えると、ビューオブジェクトのクラスに関して、SingleWindowクラスは必要最小源の情報だけを持っています。ソフトウェア工学の用語では、このように必要最小限の情報だけを抜き出すことを抽象化(abstraction)と呼びます。<br/>
<br/>
適切な抽象化を行うことは、プログラムの再利用において重要なポイントの一つです。C++などのオブジェクト指向言語は、Cなどの手続き指向言語に比べてプログラムの再利用が簡単だと言われます。これは、上の例で見たように、基底クラスを利用することで自然に抽象化を行えるからなのです。<br/>
<br/>

<hr>
<address>
Art of BeOS Programming<br/>
koga@stprec.co.jp
</address>


</div><!-- End of main -->

</div><!-- End of pagewidth -->

</body>

</html>

